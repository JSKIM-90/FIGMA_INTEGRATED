# 자산-인스턴스 매핑과 컴포넌트 독립성

**날짜**: 2025-12-08

---

## 1. 컴포넌트 독립성 논의

### 질문
대량의 독립 컴포넌트를 기계적으로 생산하려면 현재 아키텍처가 적합한가?

### 논의 결과

#### Topic/Event 하드코딩에 대해
- 현재 `register.js`에 Topic/Event가 하드코딩되어 있음
- 이는 **컴포넌트 독립성 문제가 아니라 도메인 설정 문제**
- Topic/Event는 "이 컴포넌트가 어떤 데이터를 받아서 어떤 신호를 보낼 것인가"라는 **도메인 계약(Contract)**

#### API 강결합에 대해
- API 필드 직접 참조 vs Config Injection 패턴
- 이는 **아키텍처의 제약이 아니라 구현자의 선택**
- 아키텍처는 "데이터를 전달한다"만 정의하고, "어떻게 해석할지"는 컴포넌트 구현에 맡김
- TimeTrendChart의 Config 패턴은 **좋은 구현 사례**

#### 결론
아키텍처 레벨에서 컴포넌트 독립성은 확보됨:
- 컴포넌트가 Page 없이 독립 동작 가능 (preview.html로 증명)
- 컴포넌트 간 결합이 느슨함 (Topic/Event 기반)
- Lifecycle이 명확함 (register/destroy 패턴)

---

## 2. 자산과 인스턴스 매핑 논의

### 문제 제기
자산 데이터가 변경되면 배치한 컴포넌트의 자산 ID를 바꿔야 하는데, 이 연결고리가 없으면 어떤 인스턴스가 영향받는지 알 수 없다.

### 논리 전개

```
자산 ID 변경됨
    ↓
화면에서 연결고리 없음
    ↓
어떤 인스턴스가 영향받는지 알 수 없음
    ↓
인스턴스 고유 정보 관리 필요
    ↓
그 정보를 누가 관리할 것인가?
```

### 핵심 통찰

**웹 빌더는 시각화 도구일 뿐, 자산의 주인이 아니다.**

```
실제 자산 소유자 (외부 시스템)
├── 설비 관리 시스템 → 펌프, 밸브 아이콘
├── 금융 시스템 → 로고, 차트 에셋
├── IoT 플랫폼 → 센서 이미지
└── ...

웹 빌더
└── "저 자산을 가져다가 화면에 보여줄 뿐"
```

### 자동화 가능 여부

| 작업 | 자동화 |
|------|--------|
| 자산 추출 (Figma → 파일) | 가능 |
| 자산 ID 생성 (hash) | 가능 |
| 삭제된 자산 감지 | 가능 (참조 깨짐 탐지) |
| 대체 자산 결정 | **불가능** (의미 판단 필요) |
| 인스턴스에 자산 매핑 | **불가능** (최초 1회 사람 필요) |

**"이 인스턴스가 이 자산을 쓴다"는 매핑은 반드시 사람이 한 번은 해야 한다.**

### ROI 판단

웹 빌더가 자산까지 관리하면:
```
추가 구현 필요:
- 자산 업로드/저장소
- 자산 버전 관리
- 자산 검색/브라우징 UI
- 자산 권한 관리
- 외부 시스템과 동기화
```

**웹 빌더가 DAM(Digital Asset Management)이 되어버림** → 과도한 범위 확장

반면, 배치 작업 시 자산 ID 매핑:
```
웹 빌더에서 사람이 하는 작업:
1. 컴포넌트를 화면에 배치
2. 위치/크기 조정
3. 자산 ID 입력 ← 이거 하나 추가되는 것뿐
```

어차피 1, 2번을 사람이 하는데, 3번이 큰 부담이 아님.

### 결론
**자산 ID 매핑은 배치 작업의 일부로 보고, 웹 빌더는 에디터 역할에 집중한다.**

---

## 3. 대량 배치 케이스

### 두 가지 케이스 구분

#### A. 데이터 기반 렌더링 (동적)
```
센서 2000개 → API 조회 → 테이블/리스트로 렌더링

컴포넌트는 1개 (테이블 컴포넌트)
데이터가 2000행
```
- 자산 매핑 불필요
- API 응답 구조만 맞으면 됨

#### B. 물리적 배치 (정적)
```
공장 레이아웃에 센서 2000개를 각각 위치에 배치

컴포넌트(인스턴스)가 2000개
각각 좌표, 자산 ID 필요
```
- 2000개 인스턴스 × 자산 ID 매핑 = 문제
- **하지만 이런 상황은 성능 문제로 먼저 막힘**

### 3D 대량 배치의 현실

```
렌더링: Draw call, geometry, material 2000개
상호작용: Raycasting 대상 2000개
편집: 2000개 인스턴스 정보 저장/로드
```

**배치 관리 비용 이전에 성능이 먼저 막힘**

### 결론
물리적 배치가 대량인 케이스는:
1. 성능 문제로 막히거나
2. 설계를 데이터 기반으로 바꾸거나

**어느 쪽이든 "에디터에서 자산 ID 수동 매핑 2000개"는 발생하지 않음**

---

## 최종 결론

1. **컴포넌트 독립성**: 아키텍처는 충분히 독립적. API 강결합은 구현 선택의 문제.
2. **자산 매핑**: 웹 빌더는 자산 소유자가 아니므로, 매핑은 배치 작업의 일부로 사람이 수행.
3. **대량 배치**: 데이터 기반 렌더링으로 해결. 물리적 대량 배치는 성능 문제로 현실적이지 않음.

---

## 4. 논의 건강성 진단 (메타 검토)

### 논의 흐름 복기

| 단계 | 내용 | 평가 |
|------|------|------|
| 1 | "대량 생산 적합성?" → 자동화로 오해 → 재정의 | 정상적 소통 |
| 2 | Topic/Event 하드코딩 지적 → "도메인 설정 문제" | 구분이 정확함 |
| 3 | API 강결합 지적 → "구현 선택이지 아키텍처 제약 아님" | 맞는 반론 |
| 4 | 자산-인스턴스 매핑 필요성 → 자동화 불가 논증 | 비약 없음 |
| 5 | 웹 빌더가 자산 소유? → "시각화 도구일 뿐" | 합당한 전제 |
| 6 | ROI 판단 | **검토 필요** |

### 잠재적 문제점

#### ROI 판단의 근거가 충분했나?

**주장**: "배치할 때 자산 ID 입력하는 건 큰 비용 아니다"

**검증 안 된 가정**:
- 배치 작업 빈도가 얼마나 되는가?
- 자산 변경 빈도가 얼마나 되는가?
- 변경 시 영향받는 인스턴스를 찾는 비용은?

만약:
- 자산 변경이 **자주** 일어나고
- 영향받는 인스턴스가 **많고**
- 찾는 데 **시간이 오래** 걸린다면

→ 자산 관리 시스템의 ROI가 달라질 수 있음.

**이 부분은 실제 운영 데이터 없이 판단한 것.**

#### 대량 배치 논의에서의 비약

**주장**: "2000개 물리적 배치는 성능 문제로 막힌다"

**검증 안 된 부분**:
- 정말 2000개가 임계점인가?
- Instanced Mesh 등으로 해결 가능한 범위는?
- 100개, 500개는 괜찮은가?

**"대량이면 문제"라는 결론은 맞지만, 임계점에 대한 구체적 검토 없이 넘어감.**

### 확증편향 여부

**의심되는 부분**:
"웹 빌더는 에디터 역할에 집중"이라는 결론을 향해 가고 있었고, 반론이 시도되었지만 맥락 보완에 쉽게 설득됨.

**하지만**:
반론이 무력화된 건 전제("웹 빌더는 자산 소유자가 아님")가 합당했기 때문이지, 반론을 포기한 건 아님.

### 최종 진단

| 항목 | 평가 |
|------|------|
| 논리적 비약 | 없음 |
| 확증편향 | 약간 의심 (ROI 판단 부분) |
| 검증 안 된 가정 | 있음 (빈도, 임계점) |
| 전반적 논의 건강성 | **양호** |

### 향후 검토 필요 사항

1. **ROI 판단 재검토**: 운영 데이터가 쌓이면 자산 변경 빈도, 영향 범위 분석 필요
2. **임계점 검증**: 물리적 배치 몇 개까지가 현실적인지 벤치마크 필요
3. **전제 재검토**: "웹 빌더는 자산 소유자가 아님"이 모든 프로젝트에 적용 가능한지 확인
